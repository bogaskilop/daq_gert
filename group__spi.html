<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>bcm2835: SPI access</title>

<link href="group__spi_files/tabs.css" rel="stylesheet" type="text/css">
<link href="group__spi_files/doxygen.css" rel="stylesheet" type="text/css">

<link href="group__spi_files/search.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="group__spi_files/jquery.js"></script>
<script type="text/javascript" src="group__spi_files/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellpadding="0" cellspacing="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">bcm2835
   &nbsp;<span id="projectnumber">1.10</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="http://www.open.com.au/mikem/bcm2835/index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="http://www.open.com.au/mikem/bcm2835/modules.html"><span>Modules</span></a></li>
      <li><a href="http://www.open.com.au/mikem/bcm2835/files.html"><span>Files</span></a></li>
      <li><a href="http://www.open.com.au/mikem/bcm2835/examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="group__spi_files/mag_sel.png" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()" alt="">
          <input id="MSearchField" value="Search" accesskey="S" onfocus="searchBox.OnSearchFieldFocus(true)" onblur="searchBox.OnSearchFieldFocus(false)" onkeyup="searchBox.OnSearchFieldChange(event)" type="text">
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" src="group__spi_files/close.png" alt="" border="0"></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">SPI access</div>  </div>
</div>
<div class="contents">
<table class="memberdecls">
<tbody><tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="http://www.open.com.au/mikem/bcm2835/group__spi.html#gac888dc9b78b695f6c13eeeaa813c0d82">bcm2835_spi_begin</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="http://www.open.com.au/mikem/bcm2835/group__spi.html#gad25421b3a4a6ca280dfdd39c94c3279a">bcm2835_spi_end</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="http://www.open.com.au/mikem/bcm2835/group__spi.html#ga0127eab1b6c3f8bf127bdac474fdc0f9">bcm2835_spi_setBitOrder</a> (uint8_t order)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">see <a class="el" href="http://www.open.com.au/mikem/bcm2835/group__constants.html#ga1dd00efbd834646f75240c39a41c9856">bcm2835SPIBitOrder</a>  <a href="#ga0127eab1b6c3f8bf127bdac474fdc0f9"></a><br></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="http://www.open.com.au/mikem/bcm2835/group__spi.html#gad623657d9513faa89d22ae1dc87eec38">bcm2835_spi_setClockDivider</a> (uint16_t divider)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">see <a class="el" href="http://www.open.com.au/mikem/bcm2835/group__constants.html#gaf2e0ca069b8caef24602a02e8a00884e">bcm2835SPIClockDivider</a>  <a href="#gad623657d9513faa89d22ae1dc87eec38"></a><br></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="http://www.open.com.au/mikem/bcm2835/group__spi.html#gabfbf797499756d38e3667f05ee8fd11d">bcm2835_spi_setDataMode</a> (uint8_t mode)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">see <a class="el" href="http://www.open.com.au/mikem/bcm2835/group__constants.html#ga8dd7bb496565324800130100e6bf6d86">bcm2835SPIMode</a>  <a href="#gabfbf797499756d38e3667f05ee8fd11d"></a><br></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="http://www.open.com.au/mikem/bcm2835/group__spi.html#ga2fa186568605c21e9166a19b1d82ea95">bcm2835_spi_chipSelect</a> (uint8_t cs)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="http://www.open.com.au/mikem/bcm2835/group__spi.html#gaee4edaf16fe21455441965bc57e78724">bcm2835_spi_setChipSelectPolarity</a> (uint8_t cs, uint8_t active)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="http://www.open.com.au/mikem/bcm2835/group__spi.html#ga600dc972f1064908b41b349c92d7647d">bcm2835_spi_transfer</a> (uint8_t value)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="http://www.open.com.au/mikem/bcm2835/group__spi.html#gac24692f270bb3411990ea706ddd4fee9">bcm2835_spi_transfernb</a> (char *tbuf, char *rbuf, uint32_t len)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="http://www.open.com.au/mikem/bcm2835/group__spi.html#ga06884e9cd71dfe380f846b09f47b7248">bcm2835_spi_transfern</a> (char *buf, uint32_t len)</td></tr>
</tbody></table>
<hr><a name="details" id="details"></a><h2>Detailed Description</h2>
<p>These functions let you use SPI0 (Serial Peripheral Interface) to interface with an external SPI device. </p>
<hr><h2>Function Documentation</h2>
<a class="anchor" id="gac888dc9b78b695f6c13eeeaa813c0d82"></a><!-- doxytag: member="bcm2835.h::bcm2835_spi_begin" ref="gac888dc9b78b695f6c13eeeaa813c0d82" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tbody><tr>
          <td class="memname">void bcm2835_spi_begin </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </tbody></table>
</div>
<div class="memdoc">
<p>Start SPI operations. Forces RPi SPI0 pins P1-19 (MOSI), P1-21 
(MISO), P1-23 (CLK), P1-24 (CE0) and P1-26 (CE1) to alternate function 
ALT0, which enables those pins for SPI interface. You should call <a class="el" href="http://www.open.com.au/mikem/bcm2835/group__spi.html#gad25421b3a4a6ca280dfdd39c94c3279a">bcm2835_spi_end()</a> when all SPI funcitons are complete to return the pins to their default functions </p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="http://www.open.com.au/mikem/bcm2835/group__spi.html#gad25421b3a4a6ca280dfdd39c94c3279a">bcm2835_spi_end()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga2fa186568605c21e9166a19b1d82ea95"></a><!-- doxytag: member="bcm2835.h::bcm2835_spi_chipSelect" ref="ga2fa186568605c21e9166a19b1d82ea95" args="(uint8_t cs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tbody><tr>
          <td class="memname">void bcm2835_spi_chipSelect </td>
          <td>(</td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"><em>cs</em></td><td>)</td>
          <td></td>
        </tr>
      </tbody></table>
</div>
<div class="memdoc">
<p>Sets the chip select pin(s) When an <a class="el" href="http://www.open.com.au/mikem/bcm2835/group__spi.html#ga600dc972f1064908b41b349c92d7647d">bcm2835_spi_transfer()</a> is made, the selected pin(s) will be asserted during the transfer. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tbody><tr><td class="paramdir">[in]</td><td class="paramname">cs</td><td>Specifies the CS pins(s) that are used to activate the desired slave. One of BCM2835_SPI_CS*, see <a class="el" href="http://www.open.com.au/mikem/bcm2835/group__constants.html#ga29bba154633d37d07fa130a86e4a1f2a">bcm2835SPIChipSelect</a> </td></tr>
  </tbody></table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gad25421b3a4a6ca280dfdd39c94c3279a"></a><!-- doxytag: member="bcm2835.h::bcm2835_spi_end" ref="gad25421b3a4a6ca280dfdd39c94c3279a" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tbody><tr>
          <td class="memname">void bcm2835_spi_end </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </tbody></table>
</div>
<div class="memdoc">
<p>End SPI operations. SPI0 pins P1-19 (MOSI), P1-21 (MISO), P1-23 
(CLK), P1-24 (CE0) and P1-26 (CE1) are returned to their default INPUT 
behaviour. </p>

</div>
</div>
<a class="anchor" id="ga0127eab1b6c3f8bf127bdac474fdc0f9"></a><!-- doxytag: member="bcm2835.h::bcm2835_spi_setBitOrder" ref="ga0127eab1b6c3f8bf127bdac474fdc0f9" args="(uint8_t order)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tbody><tr>
          <td class="memname">void bcm2835_spi_setBitOrder </td>
          <td>(</td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"><em>order</em></td><td>)</td>
          <td></td>
        </tr>
      </tbody></table>
</div>
<div class="memdoc">

<p>see <a class="el" href="http://www.open.com.au/mikem/bcm2835/group__constants.html#ga1dd00efbd834646f75240c39a41c9856">bcm2835SPIBitOrder</a> </p>
<p>Sets the SPI bit order NOTE: has no effect. Not supported by SPI0. Defaults to </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tbody><tr><td class="paramdir">[in]</td><td class="paramname">order</td><td>The desired bit order, one of BCM2835_SPI_BIT_ORDER_*, </td></tr>
  </tbody></table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gaee4edaf16fe21455441965bc57e78724"></a><!-- doxytag: member="bcm2835.h::bcm2835_spi_setChipSelectPolarity" ref="gaee4edaf16fe21455441965bc57e78724" args="(uint8_t cs, uint8_t active)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tbody><tr>
          <td class="memname">void bcm2835_spi_setChipSelectPolarity </td>
          <td>(</td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"><em>cs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"><em>active</em>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </tbody></table>
</div>
<div class="memdoc">
<p>Sets the chip select pin polarity for a given pin When an <a class="el" href="http://www.open.com.au/mikem/bcm2835/group__spi.html#ga600dc972f1064908b41b349c92d7647d">bcm2835_spi_transfer()</a>
 occurs, the currently selected chip select pin(s) will be asserted to 
the value given by active. When transfers are not happening, the chip 
select pin(s) return to the complement (inactive) value. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tbody><tr><td class="paramdir">[in]</td><td class="paramname">cs</td><td>The chip select pin to affect </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">active</td><td>Whether the chip select pin is to be active HIGH </td></tr>
  </tbody></table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gad623657d9513faa89d22ae1dc87eec38"></a><!-- doxytag: member="bcm2835.h::bcm2835_spi_setClockDivider" ref="gad623657d9513faa89d22ae1dc87eec38" args="(uint16_t divider)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tbody><tr>
          <td class="memname">void bcm2835_spi_setClockDivider </td>
          <td>(</td>
          <td class="paramtype">uint16_t&nbsp;</td>
          <td class="paramname"><em>divider</em></td><td>)</td>
          <td></td>
        </tr>
      </tbody></table>
</div>
<div class="memdoc">

<p>see <a class="el" href="http://www.open.com.au/mikem/bcm2835/group__constants.html#gaf2e0ca069b8caef24602a02e8a00884e">bcm2835SPIClockDivider</a> </p>
<p>Sets the SPI clock divider and therefore the SPI clock speed. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tbody><tr><td class="paramdir">[in]</td><td class="paramname">divider</td><td>The desired SPI clock divider, one of BCM2835_SPI_CLOCK_DIVIDER_*, </td></tr>
  </tbody></table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gabfbf797499756d38e3667f05ee8fd11d"></a><!-- doxytag: member="bcm2835.h::bcm2835_spi_setDataMode" ref="gabfbf797499756d38e3667f05ee8fd11d" args="(uint8_t mode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tbody><tr>
          <td class="memname">void bcm2835_spi_setDataMode </td>
          <td>(</td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"><em>mode</em></td><td>)</td>
          <td></td>
        </tr>
      </tbody></table>
</div>
<div class="memdoc">

<p>see <a class="el" href="http://www.open.com.au/mikem/bcm2835/group__constants.html#ga8dd7bb496565324800130100e6bf6d86">bcm2835SPIMode</a> </p>
<p>Sets the SPI data mode Sets the clock polariy and phase </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tbody><tr><td class="paramdir">[in]</td><td class="paramname">mode</td><td>The desired data mode, one of BCM2835_SPI_MODE*, </td></tr>
  </tbody></table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga600dc972f1064908b41b349c92d7647d"></a><!-- doxytag: member="bcm2835.h::bcm2835_spi_transfer" ref="ga600dc972f1064908b41b349c92d7647d" args="(uint8_t value)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tbody><tr>
          <td class="memname">uint8_t bcm2835_spi_transfer </td>
          <td>(</td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"><em>value</em></td><td>)</td>
          <td></td>
        </tr>
      </tbody></table>
</div>
<div class="memdoc">
<p>Transfers one byte to and from the currently selected SPI slave. 
Asserts the currently selected CS pins (as previously set by 
bcm2835_spi_chipSelect) during the transfer. Clocks the 8 bit value out 
on MOSI, and simultaneously clocks in data from MISO. Returns the read 
data byte from the slave. Uses polled transfer as per section 10.6.1 of 
teh BCM 2835 ARM Peripherls manual </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tbody><tr><td class="paramdir">[in]</td><td class="paramname">value</td><td>The 8 bit data byte to write to MOSI </td></tr>
  </tbody></table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The 8 bit byte simultaneously read from MISO </dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="http://www.open.com.au/mikem/bcm2835/group__spi.html#ga06884e9cd71dfe380f846b09f47b7248">bcm2835_spi_transfern()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga06884e9cd71dfe380f846b09f47b7248"></a><!-- doxytag: member="bcm2835.h::bcm2835_spi_transfern" ref="ga06884e9cd71dfe380f846b09f47b7248" args="(char *buf, uint32_t len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tbody><tr>
          <td class="memname">void bcm2835_spi_transfern </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"><em>len</em>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </tbody></table>
</div>
<div class="memdoc">
<p>Transfers any number of bytes to and from the currently selected SPI 
slave using bcm2835_spi_transfernb. The returned data from the slave 
replaces the transmitted data in the buffer. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tbody><tr><td class="paramdir">[in,out]</td><td class="paramname">buf</td><td>Buffer of bytes to send. Received bytes will replace the contents </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>Number of bytes int eh buffer, and the number of bytes to send/received </td></tr>
  </tbody></table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="http://www.open.com.au/mikem/bcm2835/group__spi.html#ga600dc972f1064908b41b349c92d7647d">bcm2835_spi_transfer()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="gac24692f270bb3411990ea706ddd4fee9"></a><!-- doxytag: member="bcm2835.h::bcm2835_spi_transfernb" ref="gac24692f270bb3411990ea706ddd4fee9" args="(char *tbuf, char *rbuf, uint32_t len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tbody><tr>
          <td class="memname">void bcm2835_spi_transfernb </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"><em>tbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"><em>rbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"><em>len</em>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </tbody></table>
</div>
<div class="memdoc">
<p>Transfers any number of bytes to and from the currently selected SPI 
slave. Asserts the currently selected CS pins (as previously set by 
bcm2835_spi_chipSelect) during the transfer. Clocks the len 8 bit bytes 
out on MOSI, and simultaneously clocks in data from MISO. The data read 
read from the slave is placed into rbuf. rbuf must be at least len bytes
 long Uses polled transfer as per section 10.6.1 of the BCM 2835 ARM 
Peripherls manual </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tbody><tr><td class="paramdir">[in]</td><td class="paramname">tbuf</td><td>Buffer of bytes to send. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rbuf</td><td>Received bytes will by put in this buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>Number of bytes in the tbuf buffer, and the number of bytes to send/received </td></tr>
  </tbody></table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="http://www.open.com.au/mikem/bcm2835/group__spi.html#ga600dc972f1064908b41b349c92d7647d">bcm2835_spi_transfer()</a> </dd></dl>

</div>
</div>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()" onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" name="MSearchResults" id="MSearchResults" frameborder="0">
</iframe>
</div>



<hr class="footer"><address class="footer"><small>
Generated by &nbsp;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="group__spi_files/doxygen.png" alt="doxygen">
</a> 1.7.5.1
</small></address>



</body></html>