<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>bcm2835: C library for Broadcom BCM 2835 as used in Raspberry Pi</title>

<link href="bcm2835:%20C%20library%20for%20Broadcom%20BCM%202835%20as%20used%20in%20Raspberry%20Pi_files/tabs.css" rel="stylesheet" type="text/css">
<link href="bcm2835:%20C%20library%20for%20Broadcom%20BCM%202835%20as%20used%20in%20Raspberry%20Pi_files/doxygen.css" rel="stylesheet" type="text/css">

<link href="bcm2835:%20C%20library%20for%20Broadcom%20BCM%202835%20as%20used%20in%20Raspberry%20Pi_files/search.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="bcm2835:%20C%20library%20for%20Broadcom%20BCM%202835%20as%20used%20in%20Raspberry%20Pi_files/jquery.js"></script>
<script type="text/javascript" src="bcm2835:%20C%20library%20for%20Broadcom%20BCM%202835%20as%20used%20in%20Raspberry%20Pi_files/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellpadding="0" cellspacing="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">bcm2835
   &nbsp;<span id="projectnumber">1.10</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="http://www.open.com.au/mikem/bcm2835/index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="http://www.open.com.au/mikem/bcm2835/modules.html"><span>Modules</span></a></li>
      <li><a href="http://www.open.com.au/mikem/bcm2835/files.html"><span>Files</span></a></li>
      <li><a href="http://www.open.com.au/mikem/bcm2835/examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="bcm2835:%20C%20library%20for%20Broadcom%20BCM%202835%20as%20used%20in%20Raspberry%20Pi_files/mag_sel.png" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()" alt="">
          <input id="MSearchField" value="Search" accesskey="S" onfocus="searchBox.OnSearchFieldFocus(true)" onblur="searchBox.OnSearchFieldFocus(false)" onkeyup="searchBox.OnSearchFieldChange(event)" type="text">
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" src="bcm2835:%20C%20library%20for%20Broadcom%20BCM%202835%20as%20used%20in%20Raspberry%20Pi_files/close.png" alt="" border="0"></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">C library for Broadcom BCM 2835 as used in Raspberry Pi </div>  </div>
</div>
<div class="contents">
<div class="textblock"><p>This is a C library for Raspberry Pi (RPi). It
 provides access to GPIO and other IO functions on the Broadcom BCM 2835
 chip, allowing access to the GPIO pins on the 26 pin IDE plug on the 
RPi board so you can control and interface with various external 
devices.</p>
<p>It provides functions for reading digital inputs and setting digital 
outputs. Pin event detection is supported by polling (interrupts not 
supported).</p>
<p>It is C++ compatible, and installs as a header file and non-shared 
library on any Linux-based distro (but clearly is no use except on 
Raspberry Pi or another board with BCM 2835).</p>
<p>The latest version of this documentation can be downloaded from <a href="http://www.open.com.au/mikem/bcm2835">http://www.open.com.au/mikem/bcm2835</a></p>
<p>The version of the package that this documentation refers to can be downloaded from <a href="http://www.open.com.au/mikem/bcm2835/bcm2835-1.8.tar.gz">http://www.open.com.au/mikem/bcm2835/bcm2835-1.8.tar.gz</a> You can find the latest version at <a href="http://www.open.com.au/mikem/bcm2835">http://www.open.com.au/mikem/bcm2835</a></p>
<p>Several example programs are provided.</p>
<p>Based on data in <a href="http://elinux.org/RPi_Low-level_peripherals">http://elinux.org/RPi_Low-level_peripherals</a> and <a href="http://www.raspberrypi.org/wp-content/uploads/2012/02/BCM2835-ARM-Peripherals.pdf">http://www.raspberrypi.org/wp-content/uploads/2012/02/BCM2835-ARM-Peripherals.pdf</a> and <a href="http://www.scribd.com/doc/101830961/GPIO-Pads-Control2">http://www.scribd.com/doc/101830961/GPIO-Pads-Control2</a></p>
<p>You can also find online help and discussion at <a href="http://groups.google.com/group/bcm2835">http://groups.google.com/group/bcm2835</a>
 Please use that group for all questions and discussions on this topic. 
Do not contact the author directly, unless it is to discuss commercial 
licensing.</p>
<p>Tested on debian6-19-04-2012, 2012-07-15-wheezy-raspbian and 
Occidentalisv01 CAUTION: it has been observed that when detect enables 
such as <a class="el" href="http://www.open.com.au/mikem/bcm2835/group__gpio.html#ga8e990d48db929445ac3e899ca0f5ed07">bcm2835_gpio_len()</a>
 are used and the pin is pulled LOW it can cause temporary hangs on 
2012-07-15-wheezy-raspbian and Occidentalisv01. Reason for this is not 
yet determined, but suspect that an interrupt handler is hitting a hard 
loop on those OSs. If you must use <a class="el" href="http://www.open.com.au/mikem/bcm2835/group__gpio.html#ga8e990d48db929445ac3e899ca0f5ed07">bcm2835_gpio_len()</a> and friends, make sure you disable the pins with bcm2835_gpio_cler_len() and friends after use.</p>
<dl class="user"><dt><b>Installation</b></dt><dd></dd></dl>
<p>This library consists of a single non-shared library and header file,
 which will be installed in the usual places by make install</p>
<p>tar zxvf bcm2835-1.0.tar.gz cd bcm2835-1.0 ./configure make # as root: make check make install</p>
<dl class="user"><dt><b>Physical Addresses</b></dt><dd></dd></dl>
<p>The functions bcm2845_peri_read(), bcm2845_peri_write() and 
bcm2845_peri_set_bits() are low level peripheral register access 
functions. They are designed to use physical addresses as described in 
section 1.2.3 ARM physical addresses of the BCM2835 ARM Peripherals 
manual. Physical addresses range from 0x20000000 to 0x20FFFFFF for 
peripherals. The bus addresses for peripherals are set up to map onto 
the peripheral bus address range starting at 0x7E000000. Thus a 
peripheral advertised in the manual at bus address 0x7Ennnnnn is 
available at physical address 0x20nnnnnn.</p>
<dl class="user"><dt><b>Pin Numbering</b></dt><dd></dd></dl>
<p>The GPIO pin numbering as used by RPi is different to and inconsistent with the underlying BCM 2835 chip pin numbering. <a href="http://elinux.org/RPi_BCM2835_GPIOs">http://elinux.org/RPi_BCM2835_GPIOs</a></p>
<p>RPi has a 26 pin IDE header that provides access to some of the GPIO 
pins on the BCM 2835, as well as power and ground pins. Not all GPIO 
pins on the BCM 2835 are available on the IDE header.</p>
<p>The functions in this librray are disgned to be passed the BCM 2835 
GPIO pin number and _not_ the RPi pin number. There are symbolic 
definitions for each of the available pins that you should use for 
convenience. See <a class="el" href="http://www.open.com.au/mikem/bcm2835/group__constants.html#ga63c029bd6500167152db4e57736d0939">RPiGPIOPin</a>.</p>
<dl class="user"><dt><b>SPI Pins</b></dt><dd></dd></dl>
<p>The bcm2835_spi_* functions allow you to control the BCM 2835 SPI0 
interface, allowing you to send and received data by SPI (Serial 
Peripheral Interface). For more information about SPI, see <a href="http://en.wikipedia.org/wiki/Serial_Peripheral_Interface_Bus">http://en.wikipedia.org/wiki/Serial_Peripheral_Interface_Bus</a></p>
<p>When <a class="el" href="http://www.open.com.au/mikem/bcm2835/group__spi.html#gac888dc9b78b695f6c13eeeaa813c0d82">bcm2835_spi_begin()</a>
 is called it changes the bahaviour of the SPI interface pins from their
 default GPIO behaviour in order to support SPI. While SPI is in use, 
you will not be able to control the state of the SPI pins through the 
usual bcm2835_spi_gpio_write(). When <a class="el" href="http://www.open.com.au/mikem/bcm2835/group__spi.html#gad25421b3a4a6ca280dfdd39c94c3279a">bcm2835_spi_end()</a>
 is called, the SPI pins will all revert to inputs, and can then be 
configured and controled with the usual bcm2835_gpio_* calls.</p>
<p>The Raspberry Pi GPIO pins used for SPI are:</p>
<ul>
<li>P1-19 (MOSI)</li>
<li>P1-21 (MISO)</li>
<li>P1-23 (CLK)</li>
<li>P1-24 (CE0)</li>
<li>P1-26 (CE1)</li>
</ul>
<dl class="user"><dt><b>Open Source Licensing GPL V2</b></dt><dd></dd></dl>
<p>This is the appropriate option if you want to share the source code 
of your application with everyone you distribute it to, and you also 
want to give them the right to share who uses it. If you wish to use 
this software under Open Source Licensing, you must contribute all your 
source code to the open source community in accordance with the GPL 
Version 2 when your application is distributed. See <a href="http://www.gnu.org/copyleft/gpl.html">http://www.gnu.org/copyleft/gpl.html</a> and COPYING</p>
<dl class="user"><dt><b>Acknowledgements</b></dt><dd></dd></dl>
<p>Some of this code has been inspired by Dom and Gert.</p>
<dl class="user"><dt><b>Revision History</b></dt><dd></dd></dl>
<dl class="version"><dt><b>Version:</b></dt><dd>1.0 Initial release </dd>
<dd>
1.1 Minor bug fixes </dd>
<dd>
1.2 Added support for SPI </dd>
<dd>
1.3 Added <a class="el" href="http://www.open.com.au/mikem/bcm2835/group__spi.html#ga06884e9cd71dfe380f846b09f47b7248">bcm2835_spi_transfern()</a> </dd>
<dd>
1.4 Fixed a problem that prevented SPI CE1 being used. Reported by David Robinson. </dd>
<dd>
1.5 Added <a class="el" href="http://www.open.com.au/mikem/bcm2835/group__init.html#ga3a42892f61764132d106a4ae32271002">bcm2835_close()</a> to deinit the library. Suggested by C?sar Ortiz </dd>
<dd>
1.6 Document testing on 2012-07-15-wheezy-raspbian and Occidentalisv01 Functions <a class="el" href="http://www.open.com.au/mikem/bcm2835/group__gpio.html#ga5b70fa96491b9b1d9b3fb21bfefe2fd7">bcm2835_gpio_ren()</a>, <a class="el" href="http://www.open.com.au/mikem/bcm2835/group__gpio.html#gac9ea2f8c63f0330f12e1b24444d92e50">bcm2835_gpio_fen()</a>, <a class="el" href="http://www.open.com.au/mikem/bcm2835/group__gpio.html#ga2cb94aef80b49335057e338d71e46608">bcm2835_gpio_hen()</a> <a class="el" href="http://www.open.com.au/mikem/bcm2835/group__gpio.html#ga8e990d48db929445ac3e899ca0f5ed07">bcm2835_gpio_len()</a>, <a class="el" href="http://www.open.com.au/mikem/bcm2835/group__gpio.html#gaa77a0e0d39a6b4423419a16055ce71cc">bcm2835_gpio_aren()</a> and <a class="el" href="http://www.open.com.au/mikem/bcm2835/group__gpio.html#ga7e1f1686b60043c00327255e523d98f6">bcm2835_gpio_afen()</a> now changes only the pin specified. Other pins that were already previoulsy enabled stay enabled. Added <a class="el" href="http://www.open.com.au/mikem/bcm2835/group__gpio.html#gaa5826edb1b17dd9095fa3bcae5ded485">bcm2835_gpio_clr_ren()</a>, <a class="el" href="http://www.open.com.au/mikem/bcm2835/group__gpio.html#ga196b61d8bf334be6acec590de6dc8f88">bcm2835_gpio_clr_fen()</a>, <a class="el" href="http://www.open.com.au/mikem/bcm2835/group__gpio.html#ga3c3b5297f5c2aeb5d2046a5b6de15d96">bcm2835_gpio_clr_hen()</a> <a class="el" href="http://www.open.com.au/mikem/bcm2835/group__gpio.html#gac3b51f656f5495dad715ff3c01417aea">bcm2835_gpio_clr_len()</a>, <a class="el" href="http://www.open.com.au/mikem/bcm2835/group__gpio.html#ga6f3e122871853b34d97b65284cf7cc47">bcm2835_gpio_clr_aren()</a>, <a class="el" href="http://www.open.com.au/mikem/bcm2835/group__gpio.html#ga8ec8bf224e25ed395d4eecf3ad308ca3">bcm2835_gpio_clr_afen()</a> to clear the enable for individual pins, suggested by Andreas Sundstrom. </dd>
<dd>
1.7 Added bcm2835_spi_transfernb to support different buffers for read and write. </dd>
<dd>
1.8 Improvements to read barrier, as suggested by maddin. </dd>
<dd>
1.9 Improvements contributed by mikew: I noticed that it was mallocing 
memory for the mmaps on /dev/mem. It's not necessary to do that, you can
 just mmap the file directly, so I've removed the mallocs (and frees). 
I've also modified delayMicroseconds() to use nanosleep() for long 
waits, and a busy wait on a high resolution timer for the rest. This is 
because I've found that calling nanosleep() takes at least 100-200 us. 
You need to link using '-lrt' using this version. I've added some 
unsigned casts to the debug prints to silence compiler warnings I was 
getting, fixed some typos, and changed the value of 
BCM2835_PAD_HYSTERESIS_ENABLED to 0x08 as per Gert van Loo's doc at <a href="http://www.scribd.com/doc/101830961/GPIO-Pads-Control2">http://www.scribd.com/doc/101830961/GPIO-Pads-Control2</a> Also added a define for the passwrd value that Gert says is needed to change pad control settings. </dd>
<dd>
1.10 Changed the names of the delay functions to <a class="el" href="http://www.open.com.au/mikem/bcm2835/group__gpio.html#ga3ffbe079732a995cfacd691f677d9789">bcm2835_delay()</a> and <a class="el" href="http://www.open.com.au/mikem/bcm2835/group__gpio.html#gae49c7d58397edb0200d171c8a47b272b">bcm2835_delayMicroseconds()</a> to prevent collisions with wiringPi. Macros to map delay()-&gt; <a class="el" href="http://www.open.com.au/mikem/bcm2835/group__gpio.html#ga3ffbe079732a995cfacd691f677d9789">bcm2835_delay()</a> and Macros to map delayMicroseconds()-&gt; <a class="el" href="http://www.open.com.au/mikem/bcm2835/group__gpio.html#gae49c7d58397edb0200d171c8a47b272b">bcm2835_delayMicroseconds()</a>, which can be disabled by defining BCM2835_NO_DELAY_COMPATIBILITY</dd></dl>
<dl class="author"><dt><b>Author:</b></dt><dd>Mike McCauley (<a href="mailto:mikem@open.com.au">mikem@open.com.au</a>) </dd></dl>
</div></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()" onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" name="MSearchResults" id="MSearchResults" frameborder="0">
</iframe>
</div>



<hr class="footer"><address class="footer"><small>
Generated by &nbsp;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="bcm2835:%20C%20library%20for%20Broadcom%20BCM%202835%20as%20used%20in%20Raspberry%20Pi_files/doxygen.png" alt="doxygen">
</a> 1.7.5.1
</small></address>



</body></html>